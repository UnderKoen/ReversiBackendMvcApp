"use strict";function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function asyncGeneratorStep(e,t,n,r,a,o,i){try{var u=e[o](i),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,a)}function _asyncToGenerator(u){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=u.apply(e,i);function a(e){asyncGeneratorStep(r,t,n,a,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,a,o,"throw",e)}a(void 0)})}}var Game=function(){var f,p={prev:null,gameState:null,gameId:"",playerId:""};function n(){return(n=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Game.Data.put("/api/spel/".concat(p.gameId,"/zet?token=").concat(p.playerId,"&kolom=").concat(n,"&rij=").concat(t));case 4:return e.next=6,r();case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(){return(1===p.gameState.aandeBeurt?p.gameState.speler1Token:p.gameState.speler2Token)===p.playerId}function r(){return e.apply(this,arguments)}function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,u,c,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null===p.gameState,e.next=3,Game.Model.getGameState(p.gameId);case 3:if(p.gameState=e.sent,t)Game.Reversi.showBoard(p.gameState.bord),Game.Stats.addData(p.gameState);else{for(n=!1,r=0;r<8;r++)for(a=0;a<8;a++)o=p.prev.bord[a][r],i=p.gameState.bord[a][r],o!==i&&(n=!0,Game.Reversi.showFiche(r,a,i));n&&Game.Stats.addData(p.gameState)}u=document.querySelector(".beurt"),2===p.gameState.status?(m()&&$.get("https://localhost:5002/Spel/Finish/".concat(p.gameId)).then(function(e){return e}),clearInterval(f),c=p.gameState.bord.map(function(e){return e.filter(function(e){return 1===e}).length}).reduce(function(e,t){return e+t}),s=p.gameState.bord.map(function(e){return e.filter(function(e){return 2===e}).length}).reduce(function(e,t){return e+t}),l=p.gameState.speler1Token===p.playerId,u.innerHTML=s<c?l?"Gewonnen":"Verloren":c<s?l?"Verloren":"Gewonnen":"Gelijk spel"):u.innerHTML="Beurt: "+(m()?"Jouw":"Hun"),p.prev=p.gameState;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(e,t){p.gameId=e,p.playerId=t,Game.Data.init("https://localhost:5001","production"),Game.Model.init(),Game.Template.init(),Game.API.init(),Game.Stats.init(),Game.Reversi.init(),r(),f=setInterval(r,2e3)},placeFiche:function(e,t){return n.apply(this,arguments)}}}(),FeedbackWidget=function(){function t(e){_classCallCheck(this,t),this._elementId=e}return _createClass(t,[{key:"elementId",get:function(){return this._elementId}},{key:"show",value:function(e,t){var n=document.getElementById(this._elementId);n.querySelector("p").innerText=e,n.className="alert alert-".concat(t),n.style.display="block",this.log({message:e,type:t})}},{key:"hide",value:function(){document.getElementById(this._elementId).style.display="none"}},{key:"log",value:function(e){var t=null!==(t=JSON.parse(localStorage.getItem("feedback_widget")))&&void 0!==t?t:[];10<=t.length&&t.splice(0,1),t.push(e),localStorage.setItem("feedback_widget",JSON.stringify(t))}},{key:"removeLog",value:function(){localStorage.setItem("feedback_widget","[]")}},{key:"history",value:function(){var e=(null!==(e=JSON.parse(localStorage.getItem("feedback_widget")))&&void 0!==e?e:[]).map(function(e){return"".concat(e.type," - ").concat(e.message)}).join("\n");this.show(e,"success")}}]),t}();Game.API=function(){function t(){return(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Game.Data.isEven(t);case 2:return n=e.sent,e.abrupt("return",n.iseven);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(){},isEven:function(e){return t.apply(this,arguments)}}}(),Game.Data=function(){var r={apiKey:"3421a4500faea1687908bb1feb1a9742",url:"",mock:[{url:"/api/Spel/Beurt/",data:0}]},n={environment:"development"};function t(t){var n=r.mock.filter(function(e){return e.url===t})[0];return new Promise(function(e){e(n.data)})}function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.openweathermap.org/data/2.5/weather?q=zwolle&apikey=".concat(r.apiKey),e.next=3,$.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(){return(a=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://api.isevenapi.xyz/api/iseven/".concat(t),e.next=3,$.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(e,t){if(r.url=e,t){if("development"!==t&&"production"!==t)throw new Error;n.environment=t}},get:function(e){return"development"===n.environment?t(e):$.get(r.url+e).then(function(e){return e}).catch(function(e){console.log(e.message)})},put:function(e){return"development"===n.environment?t(e):new Promise(function(t){$.ajax({url:r.url+e,type:"PUT",success:function(e){t(e)}})})},getWeather:function(){return e.apply(this,arguments)},isEven:function(e){return a.apply(this,arguments)}}}(),Game.Model=function(){function t(){return(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Game.Data.get("/api/spel/".concat(null!=t?t:""));case 2:return function(e){for(var t,n=e.bord,r=[],a=0;a<8;a++)r.push([0,0,0,0,0,0,0,0]);for(t in n){var o=n[t],i=t.split(",");r[i[0]][i[1]]=o}e.bord=r}(n=e.sent),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(){},getGameState:function(e){return t.apply(this,arguments)}}}(),Game.Reversi=function(){var r="board.body";function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(1e3*Math.random()),e.next=3,Game.API.isEven(t);case 3:n=e.sent,document.querySelector(".apiData").innerHTML=Game.Template.parseTemplate("api.isEven",{number:t,even:n});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{init:function(){!function(){e.apply(this,arguments)}()},showFiche:function(e,t,n){t=document.querySelector(".board__row__element--y-".concat(t,".board__row__element--x-").concat(e)),(e=document.createElement("div")).classList.add("fiche"),e.classList.add("fiche--".concat(n)),t.innerHTML="",t.append(e)},showBoard:function(e){document.querySelector(".board").innerHTML=Game.Template.parseTemplate(r,{board:e});for(var t=function(r){for(var e=0;e<8;e++)!function(t){var n=document.querySelector(".board__row__element--y-".concat(r,".board__row__element--x-").concat(t));n.addEventListener("click",function(e){0<n.children.length||Game.placeFiche(t,r)})}(e)},n=0;n<8;n++)t(n)}}}(),Game.Stats=function(){var t,n=[],r=[];function a(){var e=$("#myChart");null!==t&&void 0!==t&&t.destroy(),t=new Chart(e,{type:"line",data:{labels:n.map(function(e,t){return t+1}),datasets:[{label:"Player 1",data:n,fill:!1,borderColor:"rgb(46,78,78)",tension:.1},{label:"Player 2",data:r,fill:!1,borderColor:"rgb(135,212,212)",tension:.1}]},options:{scales:{y:{beginAtZero:!0}}}})}return{init:function(){a()},addData:function(e){var t=e.bord.map(function(e){return e.filter(function(e){return 1===e}).length}).reduce(function(e,t){return e+t}),e=e.bord.map(function(e){return e.filter(function(e){return 2===e}).length}).reduce(function(e,t){return e+t});n.push(t),r.push(e),a()}}}(),Game.Template=function(){function n(e){var t,n=spa_templates.templates,r=_createForOfIteratorHelper(e.split("."));try{for(r.s();!(t=r.n()).done;)n=n[t.value]}catch(e){r.e(e)}finally{r.f()}return n}return{init:function(){Handlebars.registerHelper("ifeq",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifnoteq",function(e,t,n){return e!==t?n.fn(this):n.inverse(this)})},getTemplate:n,parseTemplate:function(e,t){return n(e)(t)}}}();